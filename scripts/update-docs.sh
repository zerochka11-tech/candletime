#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
# –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–º–∏—Ç–∞ —á–µ—Ä–µ–∑ Git hook

echo "üìù –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏..."

# –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É
CURRENT_DATE=$(date +%Y-%m-%d)

# –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞—Ç—É –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ TECHNICAL_DOCUMENTATION.md
if [ -f "docs/TECHNICAL_DOCUMENTATION.md" ]; then
    # –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞—Ç—É –≤ —Ñ–∞–π–ª–µ
    if [[ "$OSTYPE" == "darwin"* ]]; then
        # macOS
        sed -i '' "s/\*\*–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:\*\*.*/\*\*–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:\*\* ${CURRENT_DATE}/" docs/TECHNICAL_DOCUMENTATION.md
        sed -i '' "s/\*\*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:\*\*.*/\*\*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:\*\* ${CURRENT_DATE}/" docs/TECHNICAL_DOCUMENTATION.md
    else
        # Linux
        sed -i "s/\*\*–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:\*\*.*/\*\*–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:\*\* ${CURRENT_DATE}/" docs/TECHNICAL_DOCUMENTATION.md
        sed -i "s/\*\*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:\*\*.*/\*\*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:\*\* ${CURRENT_DATE}/" docs/TECHNICAL_DOCUMENTATION.md
    fi
    echo "‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–∞—Ç–∞ –≤ TECHNICAL_DOCUMENTATION.md"
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ API
if git diff --cached --name-only | grep -q "app/api/"; then
    echo "‚ö†Ô∏è  –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ API. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ docs/API.md –∏ docs/TECHNICAL_DOCUMENTATION.md"
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–∏–ø–∞—Ö
if git diff --cached --name-only | grep -q "lib/types.ts"; then
    echo "‚ö†Ô∏è  –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–∏–ø–∞—Ö. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ docs/TECHNICAL_DOCUMENTATION.md (—Ä–∞–∑–¥–µ–ª '–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –º–æ–¥—É–ª–∏')"
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ SQL –º–∏–≥—Ä–∞—Ü–∏—è—Ö
if git diff --cached --name-only | grep -q "\.sql$"; then
    echo "‚ö†Ô∏è  –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ SQL –º–∏–≥—Ä–∞—Ü–∏—è—Ö. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ docs/TECHNICAL_DOCUMENTATION.md (—Ä–∞–∑–¥–µ–ª '–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö')"
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
if git diff --cached --name-only | grep -q "components/"; then
    echo "‚ö†Ô∏è  –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ docs/TECHNICAL_DOCUMENTATION.md (—Ä–∞–∑–¥–µ–ª '–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –º–æ–¥—É–ª–∏')"
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö
if git diff --cached --name-only | grep -q "package.json"; then
    echo "‚ö†Ô∏è  –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ docs/TECHNICAL_DOCUMENTATION.md (—Ä–∞–∑–¥–µ–ª '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫')"
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
if git diff --cached --name-only | grep -q "\.env"; then
    echo "‚ö†Ô∏è  –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ docs/TECHNICAL_DOCUMENTATION.md (—Ä–∞–∑–¥–µ–ª '–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è')"
fi

echo "‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–æ"
