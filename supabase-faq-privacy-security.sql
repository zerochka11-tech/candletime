-- ============================================
-- SQL скрипт для создания FAQ статьи о безопасности и приватности
-- Выполни этот скрипт в Supabase SQL Editor
-- ============================================

-- Статья: Безопасность и приватность на CandleTime
INSERT INTO articles (
  title,
  slug,
  excerpt,
  content,
  category_id,
  published,
  published_at,
  seo_title,
  seo_description,
  seo_keywords,
  reading_time
) VALUES (
  'Безопасность и приватность на CandleTime',
  'bezopasnost-i-privatnost-candletime',
  'Узнайте, как защищены ваши данные на CandleTime. Политика конфиденциальности, безопасность аккаунтов и управление приватностью свечей.',
  '<h2>Безопасность ваших данных</h2>
<p>CandleTime серьезно относится к безопасности и приватности пользователей. Мы используем современные технологии для защиты ваших данных и обеспечиваем прозрачность в вопросах конфиденциальности.</p>

<h2>Защита персональных данных</h2>

<h3>Что мы собираем?</h3>
<p>При использовании CandleTime мы собираем минимально необходимую информацию:</p>
<ul>
  <li><strong>При создании аккаунта</strong>: email адрес (для входа в систему)</li>
  <li><strong>При создании свечи</strong>: название свечи, тип, сообщение (опционально), длительность</li>
  <li><strong>Технические данные</strong>: IP-адрес, тип браузера, информация об устройстве (для обеспечения безопасности)</li>
</ul>

<h3>Что мы НЕ собираем?</h3>
<p>Мы не собираем и не храним:</p>
<ul>
  <li>Пароли в открытом виде (они хранятся в зашифрованном виде)</li>
  <li>Данные платежных карт (если в будущем появятся платные функции)</li>
  <li>Геолокацию без вашего явного согласия</li>
  <li>Данные из других сервисов без вашего разрешения</li>
</ul>

<h2>Приватность свечей</h2>

<h3>Анонимные свечи</h3>
<p>Вы можете создать анонимную свечу, выбрав соответствующую опцию при создании. В этом случае:</p>
<ul>
  <li>Ваше имя не будет отображаться на свече</li>
  <li>Свеча будет видна другим пользователям, но без указания автора</li>
  <li>Вы все равно сможете управлять свечой, если вошли в аккаунт</li>
</ul>

<h3>Публичные и приватные свечи</h3>
<p>Все свечи на CandleTime по умолчанию являются публичными и видны всем пользователям. Это позволяет:</p>
<ul>
  <li>Делиться свечами с друзьями и близкими</li>
  <li>Создавать сообщество поддержки</li>
  <li>Находить свечи других людей</li>
</ul>
<p>Если вы хотите создать приватную свечу, вы можете не указывать свое имя (создать анонимную свечу).</p>

<h2>Безопасность аккаунта</h2>

<h3>Защита паролей</h3>
<p>Мы используем современные методы шифрования для защиты ваших паролей:</p>
<ul>
  <li>Пароли хранятся в зашифрованном виде (хеширование)</li>
  <li>Мы никогда не видим ваш пароль в открытом виде</li>
  <li>Рекомендуем использовать надежные пароли (минимум 8 символов, буквы и цифры)</li>
</ul>

<h3>Двухфакторная аутентификация</h3>
<p>В будущем мы планируем добавить поддержку двухфакторной аутентификации для дополнительной защиты вашего аккаунта.</p>

<h2>Управление данными</h2>

<h3>Просмотр ваших данных</h3>
<p>Вы можете просмотреть все свои данные в личном кабинете:</p>
<ul>
  <li>Историю созданных свечей</li>
  <li>Информацию об аккаунте</li>
  <li>Настройки приватности</li>
</ul>

<h3>Удаление данных</h3>
<p>Вы можете удалить свой аккаунт в любой момент. При удалении аккаунта:</p>
<ul>
  <li>Все ваши персональные данные будут удалены</li>
  <li>Свечи, созданные вами, могут остаться (если они были публичными), но без связи с вашим аккаунтом</li>
  <li>Это действие необратимо</li>
</ul>
<p>Для удаления аккаунта обратитесь в поддержку или используйте функцию удаления в настройках профиля.</p>

<h2>Cookies и отслеживание</h2>

<h3>Использование cookies</h3>
<p>Мы используем cookies для:</p>
<ul>
  <li>Авторизации пользователей (сессионные cookies)</li>
  <li>Сохранения настроек (темная/светлая тема)</li>
  <li>Аналитики использования сайта (анонимной)</li>
</ul>
<p>Мы не используем cookies для отслеживания пользователей на других сайтах или для показа рекламы.</p>

<h3>Сторонние сервисы</h3>
<p>Мы используем следующие сторонние сервисы:</p>
<ul>
  <li><strong>Supabase</strong> — для хранения данных и аутентификации (соответствует GDPR)</li>
  <li><strong>Vercel</strong> — для хостинга сайта</li>
  <li><strong>Google Analytics</strong> (опционально) — для аналитики (анонимной)</li>
</ul>
<p>Все эти сервисы соответствуют требованиям защиты данных и не передают вашу информацию третьим лицам.</p>

<h2>Политика конфиденциальности</h2>
<p>Полная политика конфиденциальности доступна на странице <a href="/privacy">Политика конфиденциальности</a>. Там вы найдете подробную информацию о:</p>
<ul>
  <li>Какие данные мы собираем</li>
  <li>Как мы используем ваши данные</li>
  <li>Ваши права в отношении персональных данных</li>
  <li>Как связаться с нами по вопросам конфиденциальности</li>
</ul>

<h2>Безопасность для детей</h2>
<p>CandleTime предназначен для пользователей всех возрастов. Мы:</p>
<ul>
  <li>Не собираем данные детей младше 13 лет без согласия родителей</li>
  <li>Рекомендуем родителям контролировать использование сайта детьми</li>
  <li>Не показываем рекламу, которая может быть неподходящей для детей</li>
</ul>

<h2>Сообщить о проблеме</h2>
<p>Если вы обнаружили проблему с безопасностью или конфиденциальностью, пожалуйста, свяжитесь с нами:</p>
<ul>
  <li>Через форму обратной связи на сайте</li>
  <li>Написав на email поддержки</li>
  <li>Сообщив о проблеме в настройках профиля</li>
</ul>
<p>Мы серьезно относимся к каждому сообщению и постараемся решить проблему как можно быстрее.</p>

<h2>Обновления политики</h2>
<p>Мы можем периодически обновлять нашу политику конфиденциальности. О значительных изменениях мы уведомим пользователей через:</p>
<ul>
  <li>Уведомление на сайте</li>
  <li>Email рассылку (для зарегистрированных пользователей)</li>
  <li>Обновление даты в политике конфиденциальности</li>
</ul>

<h2>Часто задаваемые вопросы</h2>

<h3>Могут ли другие пользователи видеть мой email?</h3>
<p>Нет, ваш email адрес никогда не отображается другим пользователям. Он используется только для входа в систему и связи с вами.</p>

<h3>Можно ли удалить конкретную свечу?</h3>
<p>Да, если вы создали свечу и вошли в аккаунт, вы можете удалить её в разделе "Мои свечи". Если свеча была создана анонимно без аккаунта, удалить её нельзя.</p>

<h3>Хранятся ли мои сообщения к свечам?</h3>
<p>Да, сообщения к свечам хранятся в базе данных, но они видны только тем, кто имеет доступ к свече (все пользователи для публичных свечей). Мы не используем содержимое сообщений для других целей.</p>

<h3>Можно ли изменить настройки приватности после создания свечи?</h3>
<p>Если вы создали свечу анонимно, вы не сможете изменить её настройки. Если вы создали свечу через аккаунт, вы можете удалить её и создать новую с другими настройками.</p>

<h2>Заключение</h2>
<p>Безопасность и приватность — это наши приоритеты. Мы делаем все возможное, чтобы защитить ваши данные и обеспечить комфортное использование CandleTime. Если у вас есть вопросы или опасения, не стесняйтесь связаться с нами.</p>

<p>Помните: ваша приватность важна для нас. Мы никогда не будем продавать или передавать ваши данные третьим лицам без вашего явного согласия.</p>

<p>Узнайте больше о <a href="/privacy">политике конфиденциальности</a> или <a href="/light">зажгите свою первую свечу</a> прямо сейчас!</p>',
  (SELECT id FROM article_categories WHERE slug = 'faq' LIMIT 1),
  true,
  NOW() - INTERVAL '3 days',
  'Безопасность и приватность на CandleTime | FAQ',
  'Узнайте, как защищены ваши данные на CandleTime. Политика конфиденциальности, безопасность аккаунтов, управление приватностью свечей и ответы на вопросы.',
  ARRAY['безопасность', 'приватность', 'конфиденциальность', 'защита данных', 'CandleTime безопасность', 'политика конфиденциальности', 'GDPR', 'защита персональных данных'],
  6
)
ON CONFLICT (slug) DO NOTHING;

-- Проверка: посмотрим созданную статью
SELECT 
  a.id,
  a.title,
  a.slug,
  a.published,
  a.published_at,
  ac.name as category_name,
  a.reading_time,
  a.views_count,
  LENGTH(a.seo_title) as seo_title_length,
  LENGTH(a.seo_description) as seo_description_length,
  array_length(a.seo_keywords, 1) as keywords_count
FROM articles a
LEFT JOIN article_categories ac ON a.category_id = ac.id
WHERE a.slug = 'bezopasnost-i-privatnost-candletime';

