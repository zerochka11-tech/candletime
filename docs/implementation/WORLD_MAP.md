# üåç –ö–∞—Ä—Ç–∞ –º–∏—Ä–∞ —Å–æ —Å–≤–µ—á–∞–º–∏ - –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** –Ø–Ω–≤–∞—Ä—å 2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–ü—Ä–æ–µ–∫—Ç:** CandleTime - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–≤–µ—á–µ–π –Ω–∞ –∫–∞—Ä—Ç–µ –º–∏—Ä–∞

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏](#–æ–±–∑–æ—Ä-–∫–æ–Ω—Ü–µ–ø—Ü–∏–∏)
2. [–ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π](#–∞–Ω–∞–ª–∏–∑-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π)
3. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
4. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Ä–µ—à–µ–Ω–∏—è)
5. [–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö](#–∏–∑–º–µ–Ω–µ–Ω–∏—è-–≤-–±–∞–∑–µ-–¥–∞–Ω–Ω—ã—Ö)
6. [–î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è](#–¥–µ—Ç–∞–ª—å–Ω–∞—è-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
7. [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ UI](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-–∏-ui)
8. [–ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å-–∏-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
9. [–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å](#–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
10. [–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è](#–ø–æ—à–∞–≥–æ–≤–∞—è-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è-–≤–Ω–µ–¥—Ä–µ–Ω–∏—è)

---

## üéØ –û–±–∑–æ—Ä –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### –¶–µ–ª—å
–°–æ–∑–¥–∞—Ç—å –∫—Ä–∞—Å–∏–≤—É—é –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ä—Ç—É –º–∏—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –æ—Ç–∫—É–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞–∂–∏–≥–∞–ª–∏ —Å–≤–µ—á–∏. –≠—Ç–æ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –∏ —Å–æ–∑–¥–∞–µ—Ç —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é —Å–≤—è–∑—å —Å –º–µ—Å—Ç–∞–º–∏.

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- ‚úÖ **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞** - Leaflet.js —Å OpenStreetMap
- ‚úÖ **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤** - –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Å–≤–µ—á–µ–π
- ‚úÖ **–ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ **–§–∏–ª—å—Ç—Ä—ã** - –ø–æ —Ç–∏–ø—É —Å–≤–µ—á–∏, –¥–∞—Ç–µ, —Å—Ç–∞—Ç—É—Å—É
- ‚úÖ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –ø–æ —Å—Ç—Ä–∞–Ω–∞–º/–≥–æ—Ä–æ–¥–∞–º
- ‚úÖ **–ö—Ä–∞—Å–∏–≤—ã–π –¥–∏–∑–∞–π–Ω** - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∏–ª—é CandleTime

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –í–∏–¥–µ—Ç—å, –æ—Ç–∫—É–¥–∞ –∑–∞–∂–∏–≥–∞—é—Ç —Å–≤–µ—á–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –≤–æ –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏–π
- –ù–∞–π—Ç–∏ —Å–≤–µ—á–∏ –ø–∞–º—è—Ç–∏ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –≥–æ—Ä–æ–¥–µ
- –ü–æ–Ω—è—Ç—å –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞
- –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–≤—è–∑—å —Å –º–µ—Å—Ç–∞–º–∏

---

## üîç –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

#### 1. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–≤–µ—á–µ–π –Ω–∞ –∫–∞—Ä—Ç–µ
- [ ] –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–≤–µ—á–∏ (–∏–ª–∏ –≤—Å–µ –ø–æ –≤—ã–±–æ—Ä—É)
- [ ] –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤ –ø—Ä–∏ –∑—É–º–µ
- [ ] –†–∞–∑–Ω—ã–µ –∏–∫–æ–Ω–∫–∏/—Ü–≤–µ—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–≤–µ—á–µ–π
- [ ] Popup —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–≤–µ—á–µ –ø—Ä–∏ –∫–ª–∏–∫–µ

#### 2. –í—ã–±–æ—Ä –ª–æ–∫–∞—Ü–∏–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–≤–µ—á–∏
- [ ] –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ "–ú–µ—Å—Ç–æ" –≤ —Ñ–æ—Ä–º–µ —Å–æ–∑–¥–∞–Ω–∏—è
- [ ] –ü–æ–∏—Å–∫ –º–µ—Å—Ç–∞ (–≥–æ—Ä–æ–¥, —Å—Ç—Ä–∞–Ω–∞, –∞–¥—Ä–µ—Å)
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª–æ–∫–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è)
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å/—Å–∫—Ä—ã–≤–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ)

#### 3. –§–∏–ª—å—Ç—Ä—ã –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è
- [ ] –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É —Å–≤–µ—á–∏
- [ ] –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É (–∞–∫—Ç–∏–≤–Ω—ã–µ/–≤—Å–µ)
- [ ] –§–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è
- [ ] –ü–æ–∏—Å–∫ –ø–æ —Å—Ç—Ä–∞–Ω–µ/–≥–æ—Ä–æ–¥—É
- [ ] –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–≤–µ—á–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –º–∞—Ä–∫–µ—Ä

#### 4. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- [ ] –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –ø–æ —Å—Ç—Ä–∞–Ω–∞–º
- [ ] –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –ø–æ –≥–æ—Ä–æ–¥–∞–º
- [ ] –¢–æ–ø —Å—Ç—Ä–∞–Ω/–≥–æ—Ä–æ–¥–æ–≤
- [ ] –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –Ω–∞ –∫–∞—Ä—Ç–µ

### –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

#### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç—ã < 2 —Å–µ–∫—É–Ω–¥
- –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –∑—É–º–µ/–ø–∞–Ω–æ—Ä–∞–º–∏—Ä–æ–≤–∞–Ω–∏–∏
- –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è > 100 —Å–≤–µ—á–µ–π
- –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–ø–∞–≥–∏–Ω–∞—Ü–∏—è)

#### –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å
- –ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (–æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ ~10-50–∫–º)
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–∫–∞–∑ –Ω–∞ –∫–∞—Ä—Ç–µ
- –ù–∏–∫–∞–∫–∏—Ö –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –ø—É–±–ª–∏—á–Ω–æ–º API
- –°–æ–≥–ª–∞—Å–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –≥–µ–æ–¥–∞–Ω–Ω—ã–µ

#### UX/UI
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω (–º–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è)
- –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ (dark mode)
- –ü–ª–∞–≤–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏
- –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è

---

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

#### 1. Leaflet.js + React-Leaflet
**–ü–æ—á–µ–º—É Leaflet:**
- ‚úÖ –õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π (~38KB gzipped)
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π (OpenStreetMap)
- ‚úÖ –•–æ—Ä–æ—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ –ê–∫—Ç–∏–≤–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
npm install leaflet react-leaflet
npm install --save-dev @types/leaflet
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**
- Mapbox GL JS (–±–æ–ª–µ–µ –∫—Ä–∞—Å–∏–≤—ã–π, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç API key)
- Google Maps (–ø–ª–∞—Ç–Ω—ã–π, –±–æ–ª–µ–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π)

#### 2. Leaflet.markercluster
**–î–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –º–∞—Ä–∫–µ—Ä–æ–≤:**
```bash
npm install leaflet.markercluster
npm install --save-dev @types/leaflet.markercluster
```

#### 3. Nominatim (Geocoding)
**–î–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∞–¥—Ä–µ—Å–æ–≤ –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:**
- –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π API OpenStreetMap
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç API key
- Rate limit: 1 –∑–∞–ø—Ä–æ—Å/—Å–µ–∫ (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –Ω–∞—à–µ–≥–æ —Å–ª—É—á–∞—è)

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**
- Google Geocoding API (–ø–ª–∞—Ç–Ω—ã–π, –Ω–æ –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π)
- Mapbox Geocoding API (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```json
{
  "dependencies": {
    "leaflet": "^1.9.4",
    "react-leaflet": "^4.2.1",
    "leaflet.markercluster": "^1.5.3"
  },
  "devDependencies": {
    "@types/leaflet": "^1.9.8",
    "@types/leaflet.markercluster": "^1.5.4"
  }
}
```

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```
components/
  map/
    WorldMap.tsx              # –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç—ã
    MapMarker.tsx             # –ú–∞—Ä–∫–µ—Ä —Å–≤–µ—á–∏ –Ω–∞ –∫–∞—Ä—Ç–µ
    MapCluster.tsx            # –ö–ª–∞—Å—Ç–µ—Ä –º–∞—Ä–∫–µ—Ä–æ–≤
    MapControls.tsx           # –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—Ñ–∏–ª—å—Ç—Ä—ã, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
    MapPopup.tsx              # Popup —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–≤–µ—á–µ
    MapLegend.tsx             # –õ–µ–≥–µ–Ω–¥–∞ (—Ç–∏–ø—ã —Å–≤–µ—á–µ–π)
  geographic/
    LocationSelector.tsx      # –í—ã–±–æ—Ä –º–µ—Å—Ç–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–≤–µ—á–∏
    LocationDisplay.tsx       # –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Å—Ç–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å–≤–µ—á–∏
    LocationStats.tsx         # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–µ—Å—Ç–∞–º
```

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç —Å–≤–µ—á—É
   ‚Üì
2. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –≤—ã–±–∏—Ä–∞–µ—Ç –º–µ—Å—Ç–æ (—á–µ—Ä–µ–∑ LocationSelector)
   ‚Üì
3. Geocoding: –∞–¥—Ä–µ—Å ‚Üí –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (—á–µ—Ä–µ–∑ API)
   ‚Üì
4. –ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (–æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ)
   ‚Üì
5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î (candles table)
   ‚Üì
6. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–µ (WorldMap)
   ‚Üì
7. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑—É–º–µ (MapCluster)
   ‚Üì
8. Popup –ø—Ä–∏ –∫–ª–∏–∫–µ (MapPopup)
```

### API Endpoints

```
/api/geocode?q={query}              # –ì–µ–æ–∫–æ–¥–∏–Ω–≥ (–∞–¥—Ä–µ—Å ‚Üí –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã)
/api/map/candles?bounds={...}       # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–µ—á–µ–π –¥–ª—è –æ–±–ª–∞—Å—Ç–∏ –∫–∞—Ä—Ç—ã
/api/map/stats                      # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º/–≥–æ—Ä–æ–¥–∞–º
```

---

## üíæ –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `candles`

```sql
-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π –¥–ª—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
ALTER TABLE candles
ADD COLUMN IF NOT EXISTS location_type TEXT CHECK (location_type IN ('precise', 'city', 'country', 'region', 'none')) DEFAULT 'none',
ADD COLUMN IF NOT EXISTS location_country TEXT,
ADD COLUMN IF NOT EXISTS location_city TEXT,
ADD COLUMN IF NOT EXISTS location_region TEXT,
ADD COLUMN IF NOT EXISTS location_latitude DECIMAL(10, 8),
ADD COLUMN IF NOT EXISTS location_longitude DECIMAL(11, 8),
ADD COLUMN IF NOT EXISTS location_anonymized_lat DECIMAL(10, 8), -- –û–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–ª—è –∫–∞—Ä—Ç—ã
ADD COLUMN IF NOT EXISTS location_anonymized_lng DECIMAL(11, 8),
ADD COLUMN IF NOT EXISTS location_show_on_map BOOLEAN DEFAULT true, -- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏ –Ω–∞ –ø—É–±–ª–∏—á–Ω–æ–π –∫–∞—Ä—Ç–µ
ADD COLUMN IF NOT EXISTS location_address TEXT, -- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å (–¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é)
ADD COLUMN IF NOT EXISTS location_timezone TEXT; -- –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å (–¥–ª—è –±—É–¥—É—â–∏—Ö —Ñ–∏—á)

-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
CREATE INDEX IF NOT EXISTS idx_candles_location_country ON candles(location_country) WHERE location_type != 'none';
CREATE INDEX IF NOT EXISTS idx_candles_location_city ON candles(location_city) WHERE location_type != 'none';
CREATE INDEX IF NOT EXISTS idx_candles_location_anonymized ON candles(location_anonymized_lat, location_anonymized_lng) WHERE location_show_on_map = true AND location_type != 'none';
CREATE INDEX IF NOT EXISTS idx_candles_location_show ON candles(location_show_on_map) WHERE location_show_on_map = true;

-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
COMMENT ON COLUMN candles.location_type IS '–¢–∏–ø –ª–æ–∫–∞—Ü–∏–∏: precise (—Ç–æ—á–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –ø—Ä–∏–≤–∞—Ç–Ω–æ), city, country, region, none';
COMMENT ON COLUMN candles.location_anonymized_lat IS '–û–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –∫–∞—Ä—Ç–µ (–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å, ~10-50–∫–º —Ç–æ—á–Ω–æ—Å—Ç—å)';
COMMENT ON COLUMN candles.location_anonymized_lng IS '–û–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –∫–∞—Ä—Ç–µ (–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å, ~10-50–∫–º —Ç–æ—á–Ω–æ—Å—Ç—å)';
COMMENT ON COLUMN candles.location_show_on_map IS '–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏ —Å–≤–µ—á—É –Ω–∞ –ø—É–±–ª–∏—á–Ω–æ–π –∫–∞—Ä—Ç–µ';
```

### 2. –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

```sql
-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å)
-- precision_level: 1 = ~11–∫–º, 2 = ~1.1–∫–º (–∏—Å–ø–æ–ª—å–∑—É–µ–º 1 –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç–∏)
CREATE OR REPLACE FUNCTION anonymize_coordinates(
  lat DECIMAL,
  lng DECIMAL,
  precision_level INTEGER DEFAULT 1
) RETURNS TABLE(anonymized_lat DECIMAL, anonymized_lng DECIMAL) AS $$
BEGIN
  RETURN QUERY
  SELECT
    ROUND(lat::numeric, precision_level)::DECIMAL,
    ROUND(lng::numeric, precision_level)::DECIMAL;
END;
$$ LANGUAGE plpgsql IMMUTABLE;

-- –¢—Ä–∏–≥–≥–µ—Ä –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
CREATE OR REPLACE FUNCTION auto_anonymize_location()
RETURNS TRIGGER AS $$
BEGIN
  -- –ï—Å–ª–∏ –µ—Å—Ç—å —Ç–æ—á–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –∞–Ω–æ–Ω–∏–º–∏–∑–∏—Ä—É–µ–º –∏—Ö
  IF NEW.location_latitude IS NOT NULL AND NEW.location_longitude IS NOT NULL THEN
    SELECT anonymized_lat, anonymized_lng
    INTO NEW.location_anonymized_lat, NEW.location_anonymized_lng
    FROM anonymize_coordinates(NEW.location_latitude, NEW.location_longitude, 1);
  END IF;
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER trigger_auto_anonymize_location
BEFORE INSERT OR UPDATE ON candles
FOR EACH ROW
WHEN (NEW.location_latitude IS NOT NULL AND NEW.location_longitude IS NOT NULL)
EXECUTE FUNCTION auto_anonymize_location();
```

### 3. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –∫–∞—Ä—Ç—ã (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è)

```sql
-- –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–≤–µ—á–µ–π –¥–ª—è –∫–∞—Ä—Ç—ã
CREATE OR REPLACE VIEW map_candles AS
SELECT
  id,
  title,
  candle_type,
  created_at,
  expires_at,
  status,
  location_anonymized_lat AS lat,
  location_anonymized_lng AS lng,
  location_country,
  location_city,
  location_type
FROM candles
WHERE location_show_on_map = true
  AND location_type != 'none'
  AND location_anonymized_lat IS NOT NULL
  AND location_anonymized_lng IS NOT NULL;

-- –ò–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –≥—Ä–∞–Ω–∏—Ü–∞–º –∫–∞—Ä—Ç—ã
CREATE INDEX IF NOT EXISTS idx_map_candles_location ON candles USING GIST (
  POINT(location_anonymized_lng, location_anonymized_lat)
) WHERE location_show_on_map = true AND location_type != 'none';
```

### 4. RLS –ø–æ–ª–∏—Ç–∏–∫–∏ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç)

---

## üíª –î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 1. –ì–µ–æ–∫–æ–¥–∏–Ω–≥ (API Route)

**–§–∞–π–ª:** `app/api/geocode/route.ts`

```typescript
import { NextRequest, NextResponse } from 'next/server';

/**
 * –ì–µ–æ–∫–æ–¥–∏–Ω–≥ —á–µ—Ä–µ–∑ Nominatim (OpenStreetMap)
 * –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∞–¥—Ä–µ—Å/–Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—Ç–∞ –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
 */
export async function GET(request: NextRequest) {
  const searchParams = request.nextUrl.searchParams;
  const query = searchParams.get('q');

  if (!query) {
    return NextResponse.json(
      { error: 'Query parameter "q" is required' },
      { status: 400 }
    );
  }

  try {
    // Nominatim API (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π, OpenStreetMap)
    const response = await fetch(
      `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&limit=5&addressdetails=1`,
      {
        headers: {
          'User-Agent': 'CandleTime/1.0', // –¢—Ä–µ–±—É–µ—Ç—Å—è Nominatim
        },
      }
    );

    if (!response.ok) {
      throw new Error('Geocoding failed');
    }

    const data = await response.json();

    if (!data || data.length === 0) {
      return NextResponse.json({ results: [] });
    }

    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –Ω–∞—à —Ñ–æ—Ä–º–∞—Ç
    const results = data.map((item: any) => ({
      display_name: item.display_name,
      latitude: parseFloat(item.lat),
      longitude: parseFloat(item.lon),
      country: item.address?.country,
      city: item.address?.city || item.address?.town || item.address?.village,
      region: item.address?.state || item.address?.region,
      address: item.display_name,
    }));

    return NextResponse.json({ results });
  } catch (error) {
    console.error('Geocoding error:', error);
    return NextResponse.json(
      { error: 'Failed to geocode location' },
      { status: 500 }
    );
  }
}
```

### 2. API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–≤–µ—á–µ–π –¥–ª—è –∫–∞—Ä—Ç—ã

**–§–∞–π–ª:** `app/api/map/candles/route.ts`

```typescript
import { NextRequest, NextResponse } from 'next/server';
import { createClient } from '@supabase/supabase-js';

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;
const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;
const supabase = createClient(supabaseUrl, supabaseAnonKey);

/**
 * –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–µ—á–µ–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –∫–∞—Ä—Ç–µ
 * –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ –≥—Ä–∞–Ω–∏—Ü–∞–º –∫–∞—Ä—Ç—ã (bounds)
 */
export async function GET(request: NextRequest) {
  const searchParams = request.nextUrl.searchParams;
  const bounds = searchParams.get('bounds'); // "minLat,minLng,maxLat,maxLng"
  const candleType = searchParams.get('type'); // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É
  const status = searchParams.get('status') || 'active'; // active, all

  try {
    let query = supabase
      .from('candles')
      .select('id, title, candle_type, created_at, expires_at, status, location_anonymized_lat, location_anonymized_lng, location_country, location_city')
      .eq('location_show_on_map', true)
      .neq('location_type', 'none')
      .not('location_anonymized_lat', 'is', null)
      .not('location_anonymized_lng', 'is', null);

    // –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É
    if (status === 'active') {
      const now = new Date().toISOString();
      query = query.gt('expires_at', now).eq('status', 'active');
    }

    // –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É —Å–≤–µ—á–∏
    if (candleType) {
      query = query.eq('candle_type', candleType);
    }

    // –§–∏–ª—å—Ç—Ä –ø–æ –≥—Ä–∞–Ω–∏—Ü–∞–º –∫–∞—Ä—Ç—ã (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã)
    if (bounds) {
      const [minLat, minLng, maxLat, maxLng] = bounds.split(',').map(parseFloat);
      query = query
        .gte('location_anonymized_lat', minLat)
        .lte('location_anonymized_lat', maxLat)
        .gte('location_anonymized_lng', minLng)
        .lte('location_anonymized_lng', maxLng);
    }

    const { data, error } = await query.limit(1000); // –õ–∏–º–∏—Ç –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

    if (error) {
      throw error;
    }

    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –∫–∞—Ä—Ç—ã
    const candles = (data || []).map((candle) => ({
      id: candle.id,
      title: candle.title,
      type: candle.candle_type,
      lat: parseFloat(candle.location_anonymized_lat),
      lng: parseFloat(candle.location_anonymized_lng),
      country: candle.location_country,
      city: candle.location_city,
      createdAt: candle.created_at,
      expiresAt: candle.expires_at,
      status: candle.status,
    }));

    return NextResponse.json({ candles });
  } catch (error) {
    console.error('Map candles error:', error);
    return NextResponse.json(
      { error: 'Failed to fetch candles' },
      { status: 500 }
    );
  }
}
```

### 3. API –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–§–∞–π–ª:** `app/api/map/stats/route.ts`

```typescript
import { NextResponse } from 'next/server';
import { createClient } from '@supabase/supabase-js';

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;
const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;
const supabase = createClient(supabaseUrl, supabaseAnonKey);

/**
 * –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º –∏ –≥–æ—Ä–æ–¥–∞–º
 */
export async function GET() {
  try {
    // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º
    const { data: countryStats } = await supabase
      .from('candles')
      .select('location_country')
      .eq('location_show_on_map', true)
      .not('location_country', 'is', null);

    const countryCounts: Record<string, number> = {};
    countryStats?.forEach((candle) => {
      const country = candle.location_country;
      if (country) {
        countryCounts[country] = (countryCounts[country] || 0) + 1;
      }
    });

    // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≥–æ—Ä–æ–¥–∞–º (—Ç–æ–ø 20)
    const { data: cityStats } = await supabase
      .from('candles')
      .select('location_city, location_country')
      .eq('location_show_on_map', true)
      .not('location_city', 'is', null)
      .limit(1000);

    const cityCounts: Record<string, { count: number; country: string }> = {};
    cityStats?.forEach((candle) => {
      const city = candle.location_city;
      const country = candle.location_country;
      if (city) {
        if (!cityCounts[city]) {
          cityCounts[city] = { count: 0, country: country || '' };
        }
        cityCounts[city].count++;
      }
    });

    // –¢–æ–ø –≥–æ—Ä–æ–¥–æ–≤
    const topCities = Object.entries(cityCounts)
      .map(([city, data]) => ({ city, ...data }))
      .sort((a, b) => b.count - a.count)
      .slice(0, 20);

    // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –Ω–∞ –∫–∞—Ä—Ç–µ
    const { count: totalCount } = await supabase
      .from('candles')
      .select('id', { count: 'exact', head: true })
      .eq('location_show_on_map', true)
      .neq('location_type', 'none');

    return NextResponse.json({
      countries: countryCounts,
      topCities,
      totalCandles: totalCount || 0,
    });
  } catch (error) {
    console.error('Map stats error:', error);
    return NextResponse.json(
      { error: 'Failed to fetch stats' },
      { status: 500 }
    );
  }
}
```

---

## üé® –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ UI

### 1. –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç—ã

**–§–∞–π–ª:** `components/map/WorldMap.tsx`

```typescript
'use client';

import { useEffect, useState, useCallback } from 'react';
import { MapContainer, TileLayer, useMap } from 'react-leaflet';
import 'leaflet/dist/leaflet.css';
import 'leaflet.markercluster/dist/MarkerCluster.css';
import 'leaflet.markercluster/dist/MarkerCluster.Default.css';
import dynamic from 'next/dynamic';
import { MapControls } from './MapControls';
import { MapLegend } from './MapLegend';

// –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç –¥–ª—è SSR
const MapMarkers = dynamic(() => import('./MapMarkers').then(mod => ({ default: mod.MapMarkers })), {
  ssr: false,
});

interface Candle {
  id: string;
  title: string;
  type: string | null;
  lat: number;
  lng: number;
  country?: string;
  city?: string;
}

export function WorldMap() {
  const [candles, setCandles] = useState<Candle[]>([]);
  const [loading, setLoading] = useState(true);
  const [filters, setFilters] = useState({
    type: 'all' as string,
    status: 'active' as 'active' | 'all',
  });

  const loadCandles = useCallback(async () => {
    setLoading(true);
    try {
      const params = new URLSearchParams();
      if (filters.type !== 'all') {
        params.set('type', filters.type);
      }
      params.set('status', filters.status);

      const response = await fetch(`/api/map/candles?${params}`);
      const data = await response.json();
      setCandles(data.candles || []);
    } catch (error) {
      console.error('Failed to load candles:', error);
    } finally {
      setLoading(false);
    }
  }, [filters]);

  useEffect(() => {
    loadCandles();
  }, [loadCandles]);

  return (
    <div className="relative h-[600px] w-full rounded-2xl overflow-hidden border border-slate-300 dark:border-slate-700 shadow-lg">
      <MapContainer
        center={[20, 0]}
        zoom={2}
        style={{ height: '100%', width: '100%' }}
        className="z-0"
      >
        <TileLayer
          attribution='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
          url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"
        />
        <MapMarkers candles={candles} />
      </MapContainer>

      {/* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */}
      <div className="absolute top-4 left-4 z-[1000]">
        <MapControls
          filters={filters}
          onFiltersChange={setFilters}
          loading={loading}
        />
      </div>

      {/* –õ–µ–≥–µ–Ω–¥–∞ */}
      <div className="absolute bottom-4 right-4 z-[1000]">
        <MapLegend />
      </div>
    </div>
  );
}
```

### 2. –ú–∞—Ä–∫–µ—Ä—ã –Ω–∞ –∫–∞—Ä—Ç–µ

**–§–∞–π–ª:** `components/map/MapMarkers.tsx`

```typescript
'use client';

import { useEffect } from 'react';
import { useMap } from 'react-leaflet';
import L from 'leaflet';
import 'leaflet.markercluster';
import { MapPopup } from './MapPopup';

// –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∫–æ–Ω–æ–∫ Leaflet –¥–ª—è Next.js
import icon from 'leaflet/dist/images/marker-icon.png';
import iconShadow from 'leaflet/dist/images/marker-shadow.png';
import iconRetina from 'leaflet/dist/images/marker-icon-2x.png';

const DefaultIcon = L.icon({
  iconUrl: icon.src || icon,
  iconRetinaUrl: iconRetina.src || iconRetina,
  shadowUrl: iconShadow.src || iconShadow,
  iconSize: [25, 41],
  iconAnchor: [12, 41],
  popupAnchor: [1, -34],
  tooltipAnchor: [16, -28],
  shadowSize: [41, 41],
});

L.Marker.prototype.options.icon = DefaultIcon;

interface Candle {
  id: string;
  title: string;
  type: string | null;
  lat: number;
  lng: number;
  country?: string;
  city?: string;
}

interface MapMarkersProps {
  candles: Candle[];
}

// –ò–∫–æ–Ω–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–≤–µ—á–µ–π
const getCandleIcon = (type: string | null) => {
  const colors: Record<string, string> = {
    calm: '#0ea5e9', // sky
    support: '#10b981', // emerald
    memory: '#6366f1', // indigo
    gratitude: '#f59e0b', // amber
    focus: '#f43f5e', // rose
  };

  const color = colors[type || 'default'] || '#64748b';

  return L.divIcon({
    className: 'candle-marker',
    html: `<div style="
      width: 20px;
      height: 20px;
      background-color: ${color};
      border: 2px solid white;
      border-radius: 50%;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    "></div>`,
    iconSize: [20, 20],
    iconAnchor: [10, 10],
  });
};

export function MapMarkers({ candles }: MapMarkersProps) {
  const map = useMap();

  useEffect(() => {
    if (!map || candles.length === 0) return;

    // –°–æ–∑–¥–∞–µ–º –∫–ª–∞—Å—Ç–µ—Ä –≥—Ä—É–ø–ø—É
    const markers = L.markerClusterGroup({
      chunkedLoading: true,
      maxClusterRadius: 50,
    });

    // –î–æ–±–∞–≤–ª—è–µ–º –º–∞—Ä–∫–µ—Ä—ã
    candles.forEach((candle) => {
      const marker = L.marker([candle.lat, candle.lng], {
        icon: getCandleIcon(candle.type),
      });

      // Popup —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
      const popupContent = MapPopup({ candle });
      marker.bindPopup(popupContent);

      markers.addLayer(marker);
    });

    map.addLayer(markers);

    return () => {
      map.removeLayer(markers);
    };
  }, [map, candles]);

  return null;
}
```

### 3. Popup –¥–ª—è –º–∞—Ä–∫–µ—Ä–∞

**–§–∞–π–ª:** `components/map/MapPopup.tsx`

```typescript
import Link from 'next/link';

interface Candle {
  id: string;
  title: string;
  type: string | null;
  country?: string;
  city?: string;
}

export function MapPopup({ candle }: { candle: Candle }) {
  const typeLabels: Record<string, string> = {
    calm: '–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ',
    support: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞',
    memory: '–ü–∞–º—è—Ç—å',
    gratitude: '–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å',
    focus: '–§–æ–∫—É—Å',
  };

  return (
    <div className="p-2 min-w-[200px]">
      <h3 className="font-semibold text-sm text-slate-900 dark:text-slate-100 mb-1">
        {candle.title}
      </h3>
      {candle.type && (
        <p className="text-xs text-slate-600 dark:text-slate-400 mb-2">
          {typeLabels[candle.type] || candle.type}
        </p>
      )}
      {(candle.city || candle.country) && (
        <p className="text-xs text-slate-500 dark:text-slate-500 mb-2">
          üìç {[candle.city, candle.country].filter(Boolean).join(', ')}
        </p>
      )}
      <Link
        href={`/candle/${candle.id}`}
        className="text-xs text-amber-600 dark:text-amber-400 hover:underline"
      >
        –û—Ç–∫—Ä—ã—Ç—å —Å–≤–µ—á—É ‚Üí
      </Link>
    </div>
  );
}
```

### 4. –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—Ñ–∏–ª—å—Ç—Ä—ã)

**–§–∞–π–ª:** `components/map/MapControls.tsx`

```typescript
'use client';

interface MapControlsProps {
  filters: {
    type: string;
    status: 'active' | 'all';
  };
  onFiltersChange: (filters: { type: string; status: 'active' | 'all' }) => void;
  loading: boolean;
}

export function MapControls({ filters, onFiltersChange, loading }: MapControlsProps) {
  const types = [
    { value: 'all', label: '–í—Å–µ —Ç–∏–ø—ã' },
    { value: 'calm', label: '–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ' },
    { value: 'support', label: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞' },
    { value: 'memory', label: '–ü–∞–º—è—Ç—å' },
    { value: 'gratitude', label: '–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å' },
    { value: 'focus', label: '–§–æ–∫—É—Å' },
  ];

  return (
    <div className="bg-white dark:bg-slate-800 rounded-xl shadow-lg p-4 space-y-3 min-w-[200px] border border-slate-200 dark:border-slate-700">
      <h3 className="text-sm font-semibold text-slate-900 dark:text-slate-100">
        –§–∏–ª—å—Ç—Ä—ã
      </h3>

      {/* –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É */}
      <div>
        <label className="block text-xs font-medium text-slate-700 dark:text-slate-300 mb-1">
          –¢–∏–ø —Å–≤–µ—á–∏
        </label>
        <select
          value={filters.type}
          onChange={(e) => onFiltersChange({ ...filters, type: e.target.value })}
          className="w-full rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 px-2 py-1.5 text-xs text-slate-900 dark:text-slate-100"
        >
          {types.map((type) => (
            <option key={type.value} value={type.value}>
              {type.label}
            </option>
          ))}
        </select>
      </div>

      {/* –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É */}
      <div>
        <label className="block text-xs font-medium text-slate-700 dark:text-slate-300 mb-1">
          –°—Ç–∞—Ç—É—Å
        </label>
        <select
          value={filters.status}
          onChange={(e) => onFiltersChange({ ...filters, status: e.target.value as 'active' | 'all' })}
          className="w-full rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 px-2 py-1.5 text-xs text-slate-900 dark:text-slate-100"
        >
          <option value="active">–¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ</option>
          <option value="all">–í—Å–µ —Å–≤–µ—á–∏</option>
        </select>
      </div>

      {loading && (
        <div className="text-xs text-slate-500 dark:text-slate-400">
          –ó–∞–≥—Ä—É–∑–∫–∞...
        </div>
      )}
    </div>
  );
}
```

### 5. –õ–µ–≥–µ–Ω–¥–∞

**–§–∞–π–ª:** `components/map/MapLegend.tsx`

```typescript
'use client';

export function MapLegend() {
  const types = [
    { type: 'calm', label: '–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ', color: '#0ea5e9' },
    { type: 'support', label: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞', color: '#10b981' },
    { type: 'memory', label: '–ü–∞–º—è—Ç—å', color: '#6366f1' },
    { type: 'gratitude', label: '–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å', color: '#f59e0b' },
    { type: 'focus', label: '–§–æ–∫—É—Å', color: '#f43f5e' },
  ];

  return (
    <div className="bg-white dark:bg-slate-800 rounded-xl shadow-lg p-3 border border-slate-200 dark:border-slate-700">
      <h4 className="text-xs font-semibold text-slate-900 dark:text-slate-100 mb-2">
        –¢–∏–ø—ã —Å–≤–µ—á–µ–π
      </h4>
      <div className="space-y-1.5">
        {types.map((item) => (
          <div key={item.type} className="flex items-center gap-2">
            <div
              className="w-3 h-3 rounded-full border border-white dark:border-slate-700"
              style={{ backgroundColor: item.color }}
            />
            <span className="text-xs text-slate-700 dark:text-slate-300">
              {item.label}
            </span>
          </div>
        ))}
      </div>
    </div>
  );
}
```

### 6. –í—ã–±–æ—Ä –º–µ—Å—Ç–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–≤–µ—á–∏

**–§–∞–π–ª:** `components/geographic/LocationSelector.tsx`

```typescript
'use client';

import { useState, useEffect } from 'react';

interface LocationData {
  display_name: string;
  latitude: number;
  longitude: number;
  country?: string;
  city?: string;
  region?: string;
}

interface LocationSelectorProps {
  onLocationSelect: (location: LocationData | null) => void;
  initialLocation?: LocationData;
  showOnMap?: boolean;
  onShowOnMapChange?: (show: boolean) => void;
}

export function LocationSelector({
  onLocationSelect,
  initialLocation,
  showOnMap = true,
  onShowOnMapChange,
}: LocationSelectorProps) {
  const [query, setQuery] = useState('');
  const [isSearching, setIsSearching] = useState(false);
  const [results, setResults] = useState<LocationData[]>([]);
  const [selectedLocation, setSelectedLocation] = useState<LocationData | null>(
    initialLocation || null
  );

  useEffect(() => {
    onLocationSelect(selectedLocation);
  }, [selectedLocation, onLocationSelect]);

  const handleSearch = async () => {
    if (!query.trim()) return;

    setIsSearching(true);
    try {
      const response = await fetch(`/api/geocode?q=${encodeURIComponent(query)}`);
      const data = await response.json();
      setResults(data.results || []);
    } catch (error) {
      console.error('Location search error:', error);
    } finally {
      setIsSearching(false);
    }
  };

  const handleSelect = (location: LocationData) => {
    setSelectedLocation(location);
    setResults([]);
    setQuery(location.display_name);
  };

  const handleRemove = () => {
    setSelectedLocation(null);
    setQuery('');
    setResults([]);
  };

  return (
    <div className="space-y-3">
      <label className="block text-sm font-medium text-slate-900 dark:text-slate-100">
        –ú–µ—Å—Ç–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
      </label>

      {/* –ü–æ–∏—Å–∫ */}
      {!selectedLocation && (
        <div className="space-y-2">
          <div className="flex gap-2">
            <input
              type="text"
              value={query}
              onChange={(e) => setQuery(e.target.value)}
              onKeyDown={(e) => e.key === 'Enter' && handleSearch()}
              placeholder="–ì–æ—Ä–æ–¥, —Å—Ç—Ä–∞–Ω–∞ –∏–ª–∏ –∞–¥—Ä–µ—Å..."
              className="flex-1 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 px-3 py-2 text-sm text-slate-900 dark:text-slate-100"
            />
            <button
              type="button"
              onClick={handleSearch}
              disabled={isSearching || !query.trim()}
              className="rounded-lg bg-slate-900 dark:bg-slate-700 px-4 py-2 text-sm font-medium text-white disabled:opacity-50"
            >
              {isSearching ? '...' : '–ù–∞–π—Ç–∏'}
            </button>
          </div>

          {/* –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ */}
          {results.length > 0 && (
            <div className="rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 max-h-48 overflow-y-auto">
              {results.map((result, index) => (
                <button
                  key={index}
                  type="button"
                  onClick={() => handleSelect(result)}
                  className="w-full text-left px-3 py-2 hover:bg-slate-50 dark:hover:bg-slate-700 border-b border-slate-100 dark:border-slate-700 last:border-b-0"
                >
                  <p className="text-sm font-medium text-slate-900 dark:text-slate-100">
                    {result.display_name}
                  </p>
                </button>
              ))}
            </div>
          )}
        </div>
      )}

      {/* –í—ã–±—Ä–∞–Ω–Ω–æ–µ –º–µ—Å—Ç–æ */}
      {selectedLocation && (
        <div className="rounded-lg border border-emerald-200 dark:border-emerald-700 bg-emerald-50 dark:bg-emerald-900/20 p-3">
          <div className="flex items-start justify-between">
            <div className="flex-1">
              <p className="text-sm font-medium text-slate-900 dark:text-slate-100">
                üìç {selectedLocation.display_name}
              </p>
              {onShowOnMapChange && (
                <label className="mt-2 flex items-center gap-2">
                  <input
                    type="checkbox"
                    checked={showOnMap}
                    onChange={(e) => onShowOnMapChange(e.target.checked)}
                    className="rounded border-slate-300 dark:border-slate-600"
                  />
                  <span className="text-xs text-slate-600 dark:text-slate-400">
                    –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ
                  </span>
                </label>
              )}
            </div>
            <button
              type="button"
              onClick={handleRemove}
              className="text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200"
            >
              ‚úï
            </button>
          </div>
        </div>
      )}
    </div>
  );
}
```

---

## üîê –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

1. **–û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç** - –¥–æ 1 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π (~11–∫–º —Ç–æ—á–Ω–æ—Å—Ç—å)
2. **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–∫–∞–∑** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–∫—Ä—ã—Ç—å —Å–≤–µ—á—É —Å –∫–∞—Ä—Ç—ã
3. **–ù–∏–∫–∞–∫–∏—Ö –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - –Ω–∞ –∫–∞—Ä—Ç–µ —Ç–æ–ª—å–∫–æ –æ–±–æ–±—â–µ–Ω–Ω—ã–µ —Ç–æ—á–∫–∏
4. **–°–æ–≥–ª–∞—Å–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** - —è–≤–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥–µ–æ–¥–∞–Ω–Ω—ã—Ö

### RLS –ø–æ–ª–∏—Ç–∏–∫–∏

```sql
-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ –∞–Ω–æ–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥—Ä—É–≥–∏—Ö
-- –¢–æ—á–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—é —Å–≤–µ—á–∏
CREATE POLICY "Users see anonymized locations"
  ON candles FOR SELECT
  USING (
    location_type != 'precise' OR
    auth.uid() = user_id OR
    location_show_on_map = false
  );
```

---

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤** - Leaflet.markercluster –¥–ª—è > 100 —Å–≤–µ—á–µ–π
2. **–õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** - –∑–∞–≥—Ä—É–∑–∫–∞ —Å–≤–µ—á–µ–π —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∏–¥–∏–º–æ–π –æ–±–ª–∞—Å—Ç–∏ –∫–∞—Ä—Ç—ã
3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≥–µ–æ–∫–æ–¥–∏–Ω–≥–∞
4. **–ò–Ω–¥–µ–∫—Å—ã –ë–î** - –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ location_anonymized_lat/lng
5. **–õ–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤** - –º–∞–∫—Å–∏–º—É–º 1000 —Å–≤–µ—á–µ–π –∑–∞ –∑–∞–ø—Ä–æ—Å

### –ú–µ—Ç—Ä–∏–∫–∏

- –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç—ã: < 2 —Å–µ–∫—É–Ω–¥
- –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è: 60 FPS
- –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ API: < 500ms

---

## üìù –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install leaflet react-leaflet leaflet.markercluster
npm install --save-dev @types/leaflet @types/leaflet.markercluster
```

### –®–∞–≥ 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î

–í—ã–ø–æ–ª–Ω–∏—Ç—å SQL —Å–∫—Ä–∏–ø—Ç –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö" –≤ Supabase SQL Editor.

### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ API routes

–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª—ã:
- `app/api/geocode/route.ts`
- `app/api/map/candles/route.ts`
- `app/api/map/stats/route.ts`

### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

–°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ `components/map/` –∏ `components/geographic/`.

### –®–∞–≥ 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Ñ–æ—Ä–º—É —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤–µ—á–∏

–î–æ–±–∞–≤–∏—Ç—å `LocationSelector` –≤ `app/light/page.tsx`.

### –®–∞–≥ 6: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞—Ä—Ç—ã

–°–æ–∑–¥–∞—Ç—å `app/map/page.tsx` —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º `WorldMap`.

### –®–∞–≥ 7: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏—é

–î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É "–ö–∞—Ä—Ç–∞" –≤ `components/SiteHeader.tsx`.

### –®–∞–≥ 8: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–µ–æ–∫–æ–¥–∏–Ω–≥–∞
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –∫–∞—Ä—Ç–µ
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏

---

## üé® –î–∏–∑–∞–π–Ω –∏ —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è

### –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ü–≤–µ—Ç–∞ —Ç–∏–ø–æ–≤ —Å–≤–µ—á–µ–π –∏–∑ `lib/constants.ts`
- –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ –¥–ª—è dark mode
- –ü–ª–∞–≤–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–∏ hover

### –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å

- –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è: –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–∞—è –∫–∞—Ä—Ç–∞
- –ü–ª–∞–Ω—à–µ—Ç: –∫–∞—Ä—Ç–∞ —Å –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª—å—é
- –î–µ—Å–∫—Ç–æ–ø: –∫–∞—Ä—Ç–∞ —Å –ø–∞–Ω–µ–ª—å—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## üöÄ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞** - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ —Å–≤–µ—á–µ–π
2. **–ê–Ω–∏–º–∞—Ü–∏—è** - –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —Å–≤–µ—á–µ–π
3. **–≠–∫—Å–ø–æ—Ä—Ç** - —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç—ã
4. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º/–≥–æ—Ä–æ–¥–∞–º
5. **–°–æ–±—ã—Ç–∏—è** - —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –≤ —Ä–∞–∑–Ω—ã—Ö —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–∞—Ö

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –Ø–Ω–≤–∞—Ä—å 2025

